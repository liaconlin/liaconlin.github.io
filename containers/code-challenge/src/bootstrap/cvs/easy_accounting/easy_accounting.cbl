IDENTIFICATION DIVISION.
PROGRAM-ID. EasyAccounting.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT ACCOUNT-FILE
        ASSIGN TO 'ACCOUNT.DAT'
        ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD  ACCOUNT-FILE.
01  ACCOUNT-RECORD.
    88  END-OF-FILE              VALUE HIGH-VALUES.
    02  ACCOUNT-ID               PIC X(5).
    02  ACCOUNT-NAME             PIC X(30).
    02  ACCOUNT-BALANCE          PIC 9(7)V99.

WORKING-STORAGE SECTION.
01  EOF                         PIC X       VALUE 'N'.
01  RESPONSE                    PIC X(3)    VALUE SPACE.

PROCEDURE DIVISION.
    OPEN INPUT ACCOUNT-FILE
    READ ACCOUNT-FILE
        AT END MOVE 'Y' TO EOF
    END-READ
    PERFORM UNTIL EOF = 'Y'
        DISPLAY "ID: " ACCOUNT-ID
        DISPLAY "Name: " ACCOUNT-NAME
        DISPLAY "Balance: " ACCOUNT-BALANCE
        READ ACCOUNT-FILE
            AT END MOVE 'Y' TO EOF
        END-READ
    END-PERFORM
    CLOSE ACCOUNT-FILE
    DISPLAY "Please enter the operation (ADD/DELETE/EXIT): "
    ACCEPT RESPONSE
    EVALUATE RESPONSE
        WHEN "ADD"
            PERFORM ADD-ACCOUNT
        WHEN "DELETE"
            PERFORM DELETE-ACCOUNT
        WHEN "EXIT"
            STOP RUN
        WHEN OTHER
            DISPLAY "Invalid input, please try again"
    END-EVALUATE.

ADD-ACCOUNT.
    DISPLAY "Please enter the account ID, name, and balance: "
    ACCEPT ACCOUNT-ID
    ACCEPT ACCOUNT-NAME
    ACCEPT ACCOUNT-BALANCE
    OPEN OUTPUT ACCOUNT-FILE
    WRITE ACCOUNT-RECORD
    CLOSE ACCOUNT-FILE.

DELETE-ACCOUNT.
    DISPLAY "Please enter the account ID to delete: "
    ACCEPT ACCOUNT-ID
    OPEN I-O ACCOUNT-FILE
    READ ACCOUNT-FILE KEY IS ACCOUNT-ID
        INVALID KEY
            DISPLAY "Invalid account ID, please try again"
            CLOSE ACCOUNT-FILE
            STOP RUN
        NOT INVALID KEY
            DELETE ACCOUNT-FILE RECORD
    END-READ
    CLOSE ACCOUNT-FILE.
